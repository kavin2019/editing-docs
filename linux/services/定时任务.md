## 定时任务

***

### crond服务管理和访问控制

所有的定时任务都是由crond服务去管理的，所以，在开机后需要确保该服务已经启动。系统一般默认会安装crond服务并将其设为开机启动。如果没有，则可以自己将其启动并加入到开机启动项：

```
$ service crond start
$ chkconfig -l 2345 on
```



### 用户的crontab设置

用户设置定时任务的命令

```shell
crontab [OPTIONS]
OPTIONS:
-e:编辑contab定时任务。这时候会打开一个任务文件，只需要将定时任务写入文件即可。
-l：列出所有的定时任务
-r：删除所有的定时任务。（清空定时任务文件）


```

crontab -e 会打开一个定时任务的文件，写入定时任务的格式如下:

```
* * * * * command
```

`* * * * * `对应的说明：

| 项目            | 含义                                        | 范围                    |
| --------------- | ------------------------------------------- | ----------------------- |
| 第一位置"*"     | 一个小时中的第几分，如果是*表示任意一分钟   | 0-59                    |
| 第二位置的"*"   | 一天中的第几个小时，如果*号表示任意一个小时 | 0-23                    |
| 第三位置的"*"   | 一个月当中的第几天，如果是*表示任意一天     | 0-31                    |
| 第四位置的"*"   | 一年当中的第几个月，如果是* 表示任意一个月  | 0-12                    |
| 第五个位置的"*" | 一周当中的星期几，如果是*表示任意星期几     | 0-7（0和7都代表星期日） |

在每个位置可以通过特殊符号指定不同含义的值：

| 特殊符号 | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| *        | 代表任意时间                                                 |
| ，       | 代表着不连续的时间。比如："0 8,12,16, * * * 命令"，就代表每天的8点0分、12点0分、16点0分都执行命令 |
| -        | 代表一个连续的范围。比如："0 5 * * 1-6 命令"，表示每个星期一到星期六的5点0分都会执行命令 |
| */n      | 代表每隔多少时间执行一次。比如："*/10 * * * * 命令"，代表每隔十分钟执行一次命令 |

例如：

| 范例              | 解释                                                         |
| ----------------- | ------------------------------------------------------------ |
| 45 22 * * * 命令  | 在每天的22点45分执行命令                                     |
| 0 17 * * 1 命令   | 每个星期一的17点0分执行命令                                  |
| 0 5 1,15 * * 命令 | 每个月的1号和15号的5点0分执行命令                            |
| 40 4 * * 1-5 命令 | 每个星期一到星期五的4点40分执行命令                          |
| */10 4 * * * 命令 | 每天的4点内每隔10分钟执行一次命令。也就是一天执行6次         |
| 0 0 1,15 * 1命令  | 每月的1号和15号或者是星期一的0点0分执行命令。注意：星期几和几号不要同时出现，因为他们都是定义天，容易混淆。 |

